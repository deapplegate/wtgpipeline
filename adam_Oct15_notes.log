## checking out EXACTLY how bpz works:


ipython /nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//bpz.py /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.cat -COLUMNS /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/spec.APER1._aper.CWWSB_capak.list.cat.columns -MAG yes -SPECTRA CWWSB_capak.list -PRIOR hdfn_SB -CHECK yes -PLOTS yes -VERBOSE no -ZMAX 4.0 -INTERP 8 -PROBS_LITE /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.probs -OUTPUT /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz.tmp

## try these commands out:


python $BPZPATH/bpzfinalize.py /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0
## gives us: Saving  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0_bpz.cat
#Includes calculation of modified chisq (chisq2) plus different formatting
#Important: Check your results including SED fits and P(z)
Vendor:  Continuum Analytics, Inc.
Package: mkl
Message: trial mode expires in 28 days
Loading  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz ...

Loading  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz ...

Loading  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.cat ...

Loading  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.flux_comparison ...

['id', 'zb', 'zbmin', 'zbmax', 'tb', 'odds', 'zml', 'tml', 'chisq', 'M0', 'chisq2', 'nfdet', 'nfobs']
Formatting... 

Saving  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0_bpz.cat ...


python $BPZPATH/plots/webpage.py /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0 i0-63 -DIR /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/bpz_html_sex2mag
#produces html/index.html by default
Loading  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0_bpz.cat ...

Loading  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz ...

/nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3/plots/sedplotAB.py:107: FutureWarning: comparison to `None` will result in an elementwise object comparison in the future.
  elif id_str == None:
/nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3/plots/sedplotAB.py:136: FutureWarning: comparison to `None` will result in an elementwise object comparison in the future.
  if self.id == None:
sed plot 128327 / 64 : #128327
6.000 SB2_kin_capak.sed z= 0.54 odds=0.16
chisq2 =  0.30542143163
SAVING /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0_sed_128327.png

sed plot 1 / 64 : #1
/nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0_sed_1.png ALREADY EXISTS
...
CREATING /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/bpz_html/probplots/probplot128327.png...
CREATING /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/bpz_html/probplots/probplot1.png...
...


## Getting 1-sigma detection threshold level


to get background level use this:
/nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/W-S-Z+/SCIENCE/coadd_MACS1226+21_all$ ldactoasc -i coadd.stars.cat -t FIELDS -s -b -k SEXBKGND SEXBKDEV
0.001126130926 0.1328762621

Other keys that could be useful if I have to use the exact catalog used to do the dual-image sextracting:
BackGr-SUBARU-W-S-Z+ Level-SUBARU-W-S-Z+ MU_THRESHOLD-SUBARU-W-S-Z+ MaxVal-SUBARU-W-S-Z+ MU_MAX-SUBARU-W-S-Z+


## Numbers for measured mags and bpz mags (for:i=4 // filters[i]='SUBARU-10_3-1-W-J-V')


measured_bad.sum()=8465
bad_m99.sum()=2170
(fillable*bad_m99).sum()=1590
bad_99.sum()=6295
(fillable*bad_99).sum()=5573
logical_not(isfinite(measured)).sum()=0
logical_not(isfinite(fill_mags)).sum()=1302
logical_not(isfinite(fill_mags[bad_m99])).sum()=580
logical_not(isfinite(fill_mags[bad_99])).sum()=722
(measured_good*fillable).sum()=119862
(measured_bad*fillable).sum()=7163


## OUTPUT from running: python adam_do_photometry.py $cluster detect=W-C-RC aptype=aper APER1


 FILTER_WITH_LIST= None  AP_TYPE= _aper  DETECT_FILTER= W-C-RC  magtype= APER1  type= all  only_type= False  spec= False  train_first= False
 SPECTRA= CWWSB_capak.list  inputcat= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.calibrated.cat  inputcat_alter_ldac= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.calibrated.alter.cat
running: add_dummy_ifilter(inputcat,inputcat_alter_ldac)
add_dummy_ifilter| len(cols)= 320
add_dummy_ifilter| outputfile= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.calibrated.alter.cat

 filterlist= ['SUBARU-10_3-1-W-S-Z+', 'SUBARU-10_3-1-W-J-B', 'SUBARU-10_3-1-W-C-RC', 'SUBARU-10_3-1-W-C-IC', 'SUBARU-10_3-1-W-J-V']  len(filterlist)= 5

command= ldactoasc -i /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.calibrated.alter.cat -t OBJECTS -s -b -k SeqNr MAG_APER1-SUBARU-10_3-1-W-S-Z+ MAGERR_APER1-SUBARU-10_3-1-W-S-Z+ MAG_APER1-SUBARU-10_3-1-W-J-B MAGERR_APER1-SUBARU-10_3-1-W-J-B MAG_APER1-SUBARU-10_3-1-W-C-RC MAGERR_APER1-SUBARU-10_3-1-W-C-RC MAG_APER1-SUBARU-10_3-1-W-C-IC MAGERR_APER1-SUBARU-10_3-1-W-C-IC MAG_APER1-SUBARU-10_3-1-W-J-V MAGERR_APER1-SUBARU-10_3-1-W-J-V MAG_APER1-SUBARU-10_3-1-W-C-RC > /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.bpz_input.txt

inputs for adam_do_multiple_photoz.do_bpz: cluster= MACS1226+21  DETECT_FILTER= W-C-RC  AP_TYPE= _aper  filterlist= ['SUBARU-10_3-1-W-S-Z+', 'SUBARU-10_3-1-W-J-B', 'SUBARU-10_3-1-W-C-RC', 'SUBARU-10_3-1-W-C-IC', 'SUBARU-10_3-1-W-J-V']  inputcat_alter_ascii= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.bpz_input.txt  inputcat_alter_ldac= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.calibrated.alter.cat  calib_type= slr  spec= False  use_spec= False  SPECTRA= CWWSB_capak.list  picks= None  magtype= APER1  magflux= MAG  short= True  ID= SeqNr  only_type= False inputcolumns= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.bpz.columns

inputs for adam_do_multiple_photoz.do_bpz: 
	cluster: MACS1226+21
	DETECT_FILTER: W-C-RC
	AP_TYPE: _aper
	filterlist:  ['SUBARU-10_3-1-W-S-Z+', 'SUBARU-10_3-1-W-J-B', 'SUBARU-10_3-1-W-C-RC', 'SUBARU-10_3-1-W-C-IC', 'SUBARU-10_3-1-W-J-V']
	inputcat_alter_ascii:  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.bpz_input.txt
	inputcat_alter_ldac:  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.calibrated.alter.cat
	calib_type:  slr
	spec:  False
	use_spec:  False
	SPECTRA:  CWWSB_capak.list
	picks:  None
	magtype:  APER1
	magflux:  MAG
	short:  True
	ID:  SeqNr
	only_type:  False
	inputcolumns:  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.bpz.columns

 glob(os.environ["BPZPATH"]+"/FILTER/"+f)= ['/nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//FILTER/SUBARU-10_3-1-W-S-Z+.res']
 glob(os.environ["BPZPATH"]+"/FILTER/"+f)= ['/nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//FILTER/SUBARU-10_3-1-W-J-B.res']
 glob(os.environ["BPZPATH"]+"/FILTER/"+f)= ['/nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//FILTER/SUBARU-10_3-1-W-C-RC.res']
 glob(os.environ["BPZPATH"]+"/FILTER/"+f)= ['/nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//FILTER/SUBARU-10_3-1-W-C-IC.res']
 glob(os.environ["BPZPATH"]+"/FILTER/"+f)= ['/nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//FILTER/SUBARU-10_3-1-W-J-V.res']

 nsplit= 1  randsample= False  picks= None

 dict= {'magtype': 'APER1', 'SPECTRA': 'CWWSB_capak.list', 'INTERP': '8', 'calib_type': 'slr', 'BPZPATH': '/nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3/', 'CLUSTER': 'MACS1226+21', 'iaper': '1', 'AP_TYPE': '_aper', 'SUBARUDIR': '/nfs/slac/g/ki/ki18/anja/SUBARU', 'PHOTOMETRYDIR': 'PHOTOMETRY_W-C-RC_aper', 'type': 'bpz '}

command_cp_columns= cp /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.bpz.columns /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/spec.APER1._aper.CWWSB_capak.list.cat.columns

command_cp_cat= cp /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.bpz_input.txt /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.cat

 command= python /nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//bpz.py /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.cat             -COLUMNS /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/spec.APER1._aper.CWWSB_capak.list.cat.columns             -MAG yes             -SPECTRA CWWSB_capak.list             -PRIOR hdfn_SB             -CHECK yes             -PLOTS yes             -VERBOSE no             -ZMAX 4.0             -INTERP 8             -PROBS_LITE /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.probs             -OUTPUT /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz

### OUT-bpz.log: bpz's output start:
Current time  Wed Oct 14 17:42:45 2015

input params:  NMAX  =  None
input params:  FC  =  None
input params:  ODDS  =  0.95
input params:  DELTA_M_0  =  0.0
input params:  MIN_RMS  =  0.05
input params:  PLOTS  =  yes
input params:  INTERACTIVE  =  yes
input params:  ZP_OFFSETS  =  0.0
input params:  MIN_MAGERR  =  0.001
input params:  SED_DIR  =  /nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//SED/
input params:  ADD_SPEC_PROB  =  None
input params:  ONLY_TYPE  =  no
input params:  CONVOLVE_P  =  yes
input params:  PROBS2  =  no
input params:  COLUMNS  =  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/spec.APER1._aper.CWWSB_capak.list.cat.columns
input params:  NTYPES  =  None
input params:  CHECK  =  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.flux_comparison
input params:  MAG  =  yes
input params:  OUTPUT  =  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz
input params:  PROBS  =  no
input params:  ZMAX  =  4.0
input params:  GET_Z  =  yes
input params:  ZMIN  =  0.01
input params:  INTERP  =  8
input params:  DZ  =  0.01
input params:  Z_THR  =  0
input params:  MERGE_PEAKS  =  no
input params:  COLOR  =  no
input params:  N_PEAKS  =  1
input params:  EXCLUDE  =  none
input params:  AB_DIR  =  /nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//AB/
input params:  PROBS_LITE  =  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.probs
input params:  PHOTO_ERRORS  =  no
input params:  SPECTRA  =  CWWSB_capak.list
input params:  ZC  =  None
input params:  P_MIN  =  0.01
input params:  PRIOR  =  hdfn_SB
input params:  NEW_AB  =  no
input params:  INPUT  =  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.cat
input params:  VERBOSE  =  no
input params:  FILTER_DIR  =  /nfs/slac/kipac/fs1/u/awright/InstallingSoftware_extension/bpz-1.99.3//FILTER/
input params:  ADD_CONTINUOUS_PROB  =  None
input params:  MADAU  =  yes
 plots= biggles  interactive= 1
checkSED= True
File /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz exists. Copying it to /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz.bak
0.95 1.95993
ML * prior -- NOT QUITE BAYESIAN


PHOTOMETRIC CALIBRATION TESTS
If the dmag are large, add them to the .columns file (zp_offset), then re-run BPZ.
(For better results, first re-run with -ONLY_TYPE yes to fit SEDs to known spec-z.)

  fo/ft    dmag   nobj   filter
  0.997   -0.004 10838   SUBARU-10_3-1-W-S-Z+
  1.019    0.020 10633   SUBARU-10_3-1-W-J-B
  1.012    0.013 11002   SUBARU-10_3-1-W-C-RC
  1.034    0.036 11117   SUBARU-10_3-1-W-C-IC
  1.091    0.094 11003   SUBARU-10_3-1-W-J-V
fo/ft = Average f_obs/f_model weighted by f_obs/ef_obs for objects with ODDS >= 0.95
dmag = magnitude offset which should be applied (added) to the photometry (zp_offset)
nobj = # of galaxies considered in that filter (detected and high ODDS >= 0.95)
Plot Bayesian photo-z histogram?
Compare colors with photometric redshifts?

Elapsed time 00:14:44

### OUT-bpz.log: bpz's output END

adam-look: running parsebpz(catalog= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz str(n)= 0 )
['#', '1', 'ID']
['#', '2', 'Z_B']
['#', '3', 'Z_B_MIN']
['#', '4', 'Z_B_MAX']
['#', '5', 'T_B']
['#', '6', 'ODDS', '']
['#', '7', 'Z_ML']
['#', '8', 'T_ML']
['#', '9', 'CHI-SQUARED']
['#', '10', 'M_0']
asctoldac -i /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz -o /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz.temp.tab -c /tmp/awrightphotoz.conf -t STDTAB
 command= ldacaddkey -i /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz.temp.tab -o /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz.tab -t STDTAB -k BPZ_NUMBER 0 FLOAT "" 
/nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz.tab
here
 command= ldacpaste -i /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz.tab -o /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all.bpz.temp.tab -t STDTAB
 catalogs= ['/nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz.tab']  base= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all
/nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all.bpz.temp.tab
/nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.calibrated.alter.cat
331
/nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all.bpz.tab
 output= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all.bpz.tab
 command= cat /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.bpz > /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all.bpz
 command= cat /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.probs > /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all.probs
 command= cat /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/all_bpzAPER1CWWSB_capak.list1_0.flux_comparison  > /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all.flux_comparison
mag_cat= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.calibrated.alter.cat
Loading  /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all.bpz ...

 zs= [[  1.00000000e+00   3.90000000e-01   4.00000000e-02 ...,   6.00000000e+00
    2.00000000e-03  -9.90000000e+01]
 [  2.00000000e+00   3.90000000e-01   4.00000000e-02 ...,   1.00000000e+00
    0.00000000e+00  -9.90000000e+01]
 [  3.00000000e+00   4.10000000e-01   6.00000000e-02 ...,   2.77800000e+00
   -0.00000000e+00   2.07370000e+01]
 ..., 
 [  1.28325000e+05   7.00000000e-01   1.90000000e-01 ...,   5.00000000e+00
    1.76000000e-01   2.59880000e+01]
 [  1.28326000e+05   4.30000000e-01   1.60000000e-01 ...,   6.00000000e+00
    4.10000000e-02   2.58750000e+01]
 [  1.28327000e+05   5.40000000e-01   1.70000000e-01 ...,   6.00000000e+00
    6.70000000e-02   2.59750000e+01]]
 filters= ['SUBARU-10_3-1-W-S-Z+', 'SUBARU-10_3-1-W-J-B', 'SUBARU-10_3-1-W-C-RC', 'SUBARU-10_3-1-W-C-IC', 'SUBARU-10_3-1-W-J-V']
 len(all[:,0])= 128327
 len(all[0,:])= 20
 len(ft)= 128327
 -2.5*scipy.log10(ft)= [[ 40.9025296   43.95341828  41.68007094  41.13797022  42.74132543]
 [ 24.51788471  27.56914571  25.29582523  24.75339069  26.35718843]
 [ 19.92552632  23.04399762  20.73705189  20.17670818  21.84209384]
 ..., 
 [ 25.27143514  26.30358376  25.7259772   25.31437544  26.15891956]
 [ 25.83863009  26.60373522  26.00548789  26.0357843   26.18189221]
 [ 26.06492183  26.74146982  26.13456908  25.86624513  26.35908492]]
[?1034hMAG_APER1-SUBARU-10_3-1-W-S-Z+  measured_bad.sum(), measured_good.sum()= 19795 108532
MAG_APER1-SUBARU-10_3-1-W-S-Z+ min/mean/max of measured_goods:  17.6775 24.9435 37.2382
MAG_APER1-SUBARU-10_3-1-W-J-B  measured_bad.sum(), measured_good.sum()= 17602 110725
MAG_APER1-SUBARU-10_3-1-W-J-B min/mean/max of measured_goods:  17.6749 26.1447 37.5325
MAG_APER1-SUBARU-10_3-1-W-C-RC  measured_bad.sum(), measured_good.sum()= 5456 122871
MAG_APER1-SUBARU-10_3-1-W-C-RC min/mean/max of measured_goods:  18.0869 25.4967 37.1643
MAG_APER1-SUBARU-10_3-1-W-C-IC  measured_bad.sum(), measured_good.sum()= 14839 113488
MAG_APER1-SUBARU-10_3-1-W-C-IC min/mean/max of measured_goods:  17.3866 25.1447 38.0268
MAG_APER1-SUBARU-10_3-1-W-J-V  measured_bad.sum(), measured_good.sum()= 8465 119862
MAG_APER1-SUBARU-10_3-1-W-J-V min/mean/max of measured_goods:  18.3723 25.8059 36.7127

filters[i]= SUBARU-10_3-1-W-S-Z+  i= 0  ft[:,i]= [  4.35500000e-17   1.55900000e-10   1.07100000e-08 ...,   7.78800000e-11
   4.61900000e-11   3.75000000e-11]
MAG_APER1-SUBARU-10_3-1-W-S-Z+  measured_bad.sum(), measured_good.sum()= 19795 108532
MAG_APER1-SUBARU-10_3-1-W-S-Z+ measured.shape= (128327,)
MAG_APER1-SUBARU-10_3-1-W-S-Z+ min/mean/max of measured_final:  -99.0 24.9982 229.184
MAG_APER1-SUBARU-10_3-1-W-S-Z+ min/mean/max of ft_bads:  14.6238764763 34.0489178193 229.184160348
MAG_APER1-SUBARU-10_3-1-W-S-Z+ measured SUBARU-10_3-1-W-S-Z+

filters[i]= SUBARU-10_3-1-W-J-B  i= 1  ft[:,i]= [  2.62200000e-18   9.38300000e-12   6.05900000e-10 ...,   3.01000000e-11
   2.28300000e-11   2.01100000e-11]
MAG_APER1-SUBARU-10_3-1-W-J-B  measured_bad.sum(), measured_good.sum()= 17602 110725
MAG_APER1-SUBARU-10_3-1-W-J-B measured.shape= (128327,)
MAG_APER1-SUBARU-10_3-1-W-J-B min/mean/max of measured_final:  -99.0 25.9706 232.235
MAG_APER1-SUBARU-10_3-1-W-J-B min/mean/max of ft_bads:  19.5213724638 34.769731797 232.235373314
MAG_APER1-SUBARU-10_3-1-W-J-B measured SUBARU-10_3-1-W-J-B

filters[i]= SUBARU-10_3-1-W-C-RC  i= 2  ft[:,i]= [  2.12800000e-17   7.61500000e-11   5.07200000e-09 ...,   5.12400000e-11
   3.96100000e-11   3.51700000e-11]
MAG_APER1-SUBARU-10_3-1-W-C-RC  measured_bad.sum(), measured_good.sum()= 5456 122871
MAG_APER1-SUBARU-10_3-1-W-C-RC measured.shape= (128327,)
MAG_APER1-SUBARU-10_3-1-W-C-RC min/mean/max of measured_final:  -99.0 24.6045 229.962
MAG_APER1-SUBARU-10_3-1-W-C-RC min/mean/max of ft_bads:  15.4016191778 36.9554245385 229.961600611
MAG_APER1-SUBARU-10_3-1-W-C-RC measured SUBARU-10_3-1-W-C-RC

filters[i]= SUBARU-10_3-1-W-C-IC  i= 3  ft[:,i]= [  3.50600000e-17   1.25500000e-10   8.49800000e-09 ...,   7.48600000e-11
   3.85200000e-11   4.50300000e-11]
MAG_APER1-SUBARU-10_3-1-W-C-IC  measured_bad.sum(), measured_good.sum()= 14839 113488
MAG_APER1-SUBARU-10_3-1-W-C-IC measured.shape= (128327,)
MAG_APER1-SUBARU-10_3-1-W-C-IC min/mean/max of measured_final:  -99.0 25.2009 229.419
MAG_APER1-SUBARU-10_3-1-W-C-IC min/mean/max of ft_bads:  14.8596443449 37.6183208112 229.419416197
MAG_APER1-SUBARU-10_3-1-W-C-IC measured SUBARU-10_3-1-W-C-IC

filters[i]= SUBARU-10_3-1-W-J-V  i= 4  ft[:,i]= [  8.00700000e-18   2.86500000e-11   1.83300000e-09 ...,   3.43900000e-11
   3.36700000e-11   2.86000000e-11]
MAG_APER1-SUBARU-10_3-1-W-J-V  measured_bad.sum(), measured_good.sum()= 8465 119862
MAG_APER1-SUBARU-10_3-1-W-J-V measured.shape= (128327,)
MAG_APER1-SUBARU-10_3-1-W-J-V min/mean/max of measured_final:  -99.0 25.2031 229.065
MAG_APER1-SUBARU-10_3-1-W-J-V min/mean/max of ft_bads:  16.4629843012 37.6926536072 229.064963149
MAG_APER1-SUBARU-10_3-1-W-J-V measured SUBARU-10_3-1-W-J-V
 len(cols)= 262
 outputfile= /nfs/slac/g/ki/ki18/anja/SUBARU/MACS1226+21/PHOTOMETRY_W-C-RC_aper/MACS1226+21.APER1.1.CWWSB_capak.list.all.EVERY.cat


## below here is the code that made the hists

mag = pyfits.open(mag_cat)[1]
measured = mag.data.field('MAG_APER1-'+filters[i]).copy()
bad_m99=(measured==-99)
bad_99=(measured==99)
measured_bad=(measured==-99)+(measured==99)
measured_bad.sum()
bad_m99.sum()
bad_99.sum()
measured_good=logical_not(measured_bad)
fill_mags=-2.5*scipy.log10(ft[:,i])
logical_not(isfinite(measured)).sum()
#look: logical_not(isfinite(measured)).sum()=0
logical_not(isfinite(fill_mags)).sum()
#look: logical_not(isfinite(fill_mags)).sum()=1302
logical_not(isfinite(fill_mags[bad_m99])).sum()
logical_not(isfinite(fill_mags[bad_99])).sum()
fillable=isfinite(fill_mags)
fill_mags.shape
fill_mags.shape, fillable.shape, bad_m99.shape, bad_99.shape
f=figure()
fill_mags[bad_99][logical_not(isfinite(fill_mags[bad_99]))]
fill_mags[bad_m99][logical_not(isfinite(fill_mags[bad_m99]))]
fill_mags.min()
measured.min()
measured[measured_good].min()
f,axes=imagetools.AxesList(f,(3,2))
ax=axes[0]
ax.hist(fill_mags[isfinite(fill_mags)],bins=100)
ax.set_title("fill_mags[isfinite(fill_mags)]")
(fillable*bad_m99).sum()
(fillable).sum()
(bad_m99).sum()
(fillable*bad_99).sum()
ax=axes[1]
ax.hist(fill_mags[fillable*bad_m99],bins=100)
ax.set_title("fill_mags[fillable*bad_m99]")
ax=axes[2]
ax.hist(fill_mags[fillable*bad_99],bins=100)
ax.set_title("fill_mags[fillable*bad_99]")
ax=axes[3]
measured_good.sum()
ax.hist(measured[measured_good],bins=100)
ax.set_title("measured[measured_good]")
ax=axes[4]
(measured_good*fillable).sum()
(measured_bad*fillable).sum()
ax.hist(measured[measured_good*fillable],bins=100)
ax.set_title("measured[measured_good*fillable]")
show()
f=figure()
hist(fill_mags[fillable*bad_m99],bins=100,type="step",hatch="\\",color='r')
hist(fill_mags[fillable*bad_m99],bins=100,histtype="step",hatch="\\",color='r')
hist(fill_mags[fillable*bad_99],bins=100,histtype="step",hatch="//",color='b',label="fill_mags[fillable*bad_99]")
legend()
show()
fillable_bads=fill_mags[fillable*measured_bad]
fillable_bads.min()
minmin=fillable_bads.min()
fillable_bads.max()
maxmax=fillable_bads.max()
len(arange(16,230))
bins=arange(16,230)
f=figure()
hist(fill_mags[fillable*bad_m99],bins=bins,histtype="step",hatch="\\",color='r',label="fill_mags[fillable*bad_m99]")
hist(fill_mags[fillable*bad_99],bins=bins,histtype="step",hatch="//",color='b',label="fill_mags[fillable*bad_99]")
legend()
title("Distribution of ft[:,i] values where they can and should replace measured mags")
xlabel("magnitude")
show()
f=figure()
hist(fill_mags[fillable*bad_m99],bins=bins,histtype="step",hatch="\\",color='r',label="fill_mags[fillable*bad_m99]")
hist(fill_mags[fillable*bad_99],bins=bins,histtype="step",hatch="//",color='b',label="fill_mags[fillable*bad_99]")
title("Distribution of ft[:,i] values where they can and should replace measured mags")
xlabel("magnitude")
hist(measured[measured_good],bins=bins,histtype="step",hatch="_",color='g',label="measured[measured_good]")
legend()
show()
